<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a4j="http://richfaces.org/a4j"
	template="/WEB-INF/incl/layout/template.xhtml">

	<ui:define name="body">

		<h:form id="mainForm">
			<h1>Welcome to oxAuth RP!</h1>

			<div>
				<rich:panel>
					<f:facet name="header">OpenID Connect Discovery (Webfinger)</f:facet>
					<a4j:region>
						<h:panelGroup layout="block">
							<div>
								<strong> Please enter an identifier of the target
									End-User that is the subject of the discovery request. </strong>
							</div>
							<div>
								<h:panelGrid columns="3">
									<h:outputLabel for="resource">Resource</h:outputLabel>
									<h:inputText id="resource"
										value="#{openIdConnectDiscoveryAction.resource}" size="40" />
									<h:outputText
										value="eg: acct:user@example.domain  or https://idp.example.domain/" />
									<h:outputLabel for="acceptUntrustedCertificate">Accept Untrusted Certificate</h:outputLabel>
									<h:selectBooleanCheckbox id="acceptUntrustedCertificate"
										value="#{openIdConnectDiscoveryAction.acceptUntrustedCertificate}" />
								</h:panelGrid>
							</div>
						</h:panelGroup>

						<div class="actionButtons">
							<a4j:commandButton value="Submit"
								action="#{openIdConnectDiscoveryAction.exec}" execute="@region"
								render="discoveryResults, registrationForm, authorizationForm, tokenForm, userInfoForm, checkSessionForm, endSessionForm" />
						</div>

					</a4j:region>

					<h:panelGroup layout="block" id="discoveryResults">
						<h:panelGroup layout="block" rendered="#{openIdConnectDiscoveryAction.showResults}">
							<br />
							<hr />
							<br />
							<rich:panel>
								<f:facet name="header">Identifier Normalization</f:facet>
								<h:panelGroup layout="block">
									<div>
										<h:panelGrid columns="2">
											<h:outputLabel>Resource</h:outputLabel>
											<h:outputText
												value="#{openIdConnectDiscoveryAction.resource}" />

											<h:outputLabel>Host</h:outputLabel>
											<h:outputText value="#{openIdConnectDiscoveryAction.host}" />

											<h:outputLabel>Rel</h:outputLabel>
											<h:outputText value="#{openIdConnectDiscoveryAction.rel}" />
										</h:panelGrid>
									</div>
								</h:panelGroup>
							</rich:panel>
							<br />
							<rich:panel>
								<f:facet name="header">Webfinger Request</f:facet>
								<h:panelGroup layout="block">
									<h:inputTextarea readonly="true" styleClass="width100" rows="4"
										value="#{openIdConnectDiscoveryAction.requestString1}" />
								</h:panelGroup>
							</rich:panel>
							<br />
							<rich:panel>
								<f:facet name="header">Webfinger Response</f:facet>
								<h:panelGroup layout="block">
									<h:inputTextarea readonly="true" styleClass="width100"
										rows="10"
										value="#{openIdConnectDiscoveryAction.responseString1}" />
								</h:panelGroup>
							</rich:panel>
							<br />
							<hr />
							<br />
							<rich:panel>
								<f:facet name="header">Configuration Request</f:facet>
								<h:panelGroup layout="block">
									<h:inputTextarea readonly="true" styleClass="width100" rows="4"
										value="#{openIdConnectDiscoveryAction.requestString2}" />
								</h:panelGroup>
							</rich:panel>
							<br />
							<rich:panel>
								<f:facet name="header">Configuration Response</f:facet>
								<h:panelGroup layout="block">
									<h:inputTextarea readonly="true" styleClass="width100"
										rows="15"
										value="#{openIdConnectDiscoveryAction.responseString2}" />
								</h:panelGroup>
							</rich:panel>
						</h:panelGroup>
					</h:panelGroup>
				</rich:panel>
			</div>

			<br />

			<div>
				<rich:panel>
					<f:facet name="header">Dynamic Client Registration</f:facet>
					<a4j:region>
						<h:panelGroup layout="block" id="registrationForm">
							<div>
								<strong> Please fill the form to register with an
									OpenID Provider to acquire a Client ID and shared secret. </strong>
							</div>
							<div>
								<h:panelGrid columns="3">
									<h:outputLabel for="registrationEndpoint">Registration Endpoint</h:outputLabel>
									<h:inputText id="registrationEndpoint"
										value="#{registrationAction.registrationEndpoint}" size="40" />
									<h:outputText>eg: https://seed.gluu.org/oxauth/restv1/register</h:outputText>

									<h:outputLabel for="redirectUris">Redirect URIs (space-separated)</h:outputLabel>
									<h:inputText id="redirectUris"
										value="#{registrationAction.redirectUris}" size="40" />
									<h:outputText>eg: https://seed.gluu.org/oxauth-rp/home.htm</h:outputText>

									<h:outputLabel for="claimsRedirectUris">Claims Redirect URIs (space-separated)</h:outputLabel>
									<h:inputText id="claimsRedirectUris"
												 value="#{registrationAction.claimsRedirectUris}" size="40" />
									<h:outputText>eg: https://seed.gluu.org/oxauth/restv1/uma/gather_claims</h:outputText>

									<h:outputLabel for="postLogoutRedirectUris">Post Logout Redirect URIs (space-separated)</h:outputLabel>
									<h:inputText id="postLogoutRedirectUris"
										value="#{registrationAction.postLogoutRedirectUris}" size="40" />
									<h:outputText></h:outputText>

									<h:outputLabel for="registrationResponseType">Response Types</h:outputLabel>
									<h:selectManyListbox id="registrationResponseType"
										value="#{registrationAction.responseTypes}" converter="omnifaces.GenericEnumConverter">
										<f:selectItems value="#{responseTypes}" />
									</h:selectManyListbox>
									<h:outputText></h:outputText>

									<h:outputLabel for="registrationGrantType">Grant Types</h:outputLabel>
									<h:selectManyListbox id="registrationGrantType"
										value="#{registrationAction.grantTypes}" converter="omnifaces.GenericEnumConverter">
										<f:selectItems value="#{grantTypes}" />
									</h:selectManyListbox>
									<h:outputText></h:outputText>

									<h:outputLabel for="applicationType">Application Type</h:outputLabel>
									<h:selectOneMenu id="applicationType"
										value="#{registrationAction.applicationType}" converter="omnifaces.GenericEnumConverter">
										<f:selectItem itemLabel="- Please select one -" />
										<f:selectItems value="#{applicationTypes}" />
									</h:selectOneMenu>
									<h:outputText></h:outputText>

									<h:outputLabel for="contacts">Contacts (space-separated)</h:outputLabel>
									<h:inputText id="contacts"
										value="#{registrationAction.contacts}" size="40" />
									<h:outputText>eg: javier@gluu.org</h:outputText>

									<h:outputLabel for="clientName">Client Name</h:outputLabel>
									<h:inputText id="clientName"
										value="#{registrationAction.clientName}" size="40" />
									<h:outputText>eg: Test app</h:outputText>

									<h:outputLabel for="logoUri">Logo URI</h:outputLabel>
									<h:inputText id="logoUri" value="#{registrationAction.logoUri}"
										size="40" />
									<h:outputText>eg: http://www.gluu.org/wp-content/uploads/2013/08/logo.png</h:outputText>

									<h:outputLabel for="clientUri">Client URI</h:outputLabel>
									<h:inputText id="clientUri"
										value="#{registrationAction.clientUri}" size="40" />
									<h:outputText></h:outputText>

									<h:outputLabel for="policyUri">Policy URI</h:outputLabel>
									<h:inputText id="policyUri"
										value="#{registrationAction.policyUri}" size="40" />
									<h:outputText></h:outputText>

									<h:outputLabel for="tosUri">Terms of Service URI</h:outputLabel>
									<h:inputText id="tosUri" value="#{registrationAction.tosUri}"
										size="40" />
									<h:outputText></h:outputText>

									<h:outputLabel for="jwksUri">JSON Web Key Set URI</h:outputLabel>
									<h:inputText id="jwksUri" value="#{registrationAction.jwksUri}"
										size="40" />
									<h:outputText>eg: https://seed.gluu.org/oxauth-client/test/resources/jwks.json</h:outputText>

									<h:outputLabel for="sectorIdentifierUri">Sector Identifier URI</h:outputLabel>
									<h:inputText id="sectorIdentifierUri"
										value="#{registrationAction.sectorIdentifierUri}" size="40" />
									<h:outputText>eg: https://seed.gluu.org/oxauth-client/test/resources/sector_identifier.js</h:outputText>

									<h:outputLabel for="subjectType">Subject Type</h:outputLabel>
									<h:selectOneMenu id="subjectType"
										value="#{registrationAction.subjectType}" converter="omnifaces.GenericEnumConverter">
										<f:selectItem itemLabel="- Please select one -" />
										<f:selectItems value="#{subjectTypes}" />
									</h:selectOneMenu>
									<h:outputText></h:outputText>

									<h:outputLabel for="idTokenSignedResponseAlg">ID Token Signed Response Alg</h:outputLabel>
									<h:selectOneMenu id="idTokenSignedResponseAlg"
										value="#{registrationAction.idTokenSignedResponseAlg}" converter="omnifaces.GenericEnumConverter">
										<f:selectItem itemLabel="- Please select one -" />
										<f:selectItems value="#{signatureAlgorithms}" />
									</h:selectOneMenu>
									<h:outputText></h:outputText>

									<h:outputLabel for="idTokenEncryptedResponseAlg">ID Token Encrypted Response Alg</h:outputLabel>
									<h:selectOneMenu id="idTokenEncryptedResponseAlg"
										value="#{registrationAction.idTokenEncryptedResponseAlg}" converter="omnifaces.GenericEnumConverter">
										<f:selectItem itemLabel="- Please select one -" />
										<f:selectItems value="#{keyEncryptionAlgorithms}" />
									</h:selectOneMenu>
									<h:outputText></h:outputText>

									<h:outputLabel for="idTokenEncryptedResponseEnc">ID Token Encrypted Response Enc</h:outputLabel>
									<h:selectOneMenu id="idTokenEncryptedResponseEnc"
										value="#{registrationAction.idTokenEncryptedResponseEnc}" converter="omnifaces.GenericEnumConverter">
										<f:selectItem itemLabel="- Please select one -" />
										<f:selectItems value="#{blockEncryptionAlgorithms}" />
									</h:selectOneMenu>
									<h:outputText></h:outputText>

									<h:outputLabel for="userInfoSignedResponseAlg">User Info Signed Response Alg</h:outputLabel>
									<h:selectOneMenu id="userInfoSignedResponseAlg"
										value="#{registrationAction.userInfoSignedResponseAlg}" converter="omnifaces.GenericEnumConverter">
										<f:selectItem itemLabel="- Please select one -" />
										<f:selectItems value="#{signatureAlgorithms}" />
									</h:selectOneMenu>
									<h:outputText></h:outputText>

									<h:outputLabel for="userInfoEncryptedResponseAlg">User Info Encrypted Response Alg</h:outputLabel>
									<h:selectOneMenu id="userInfoEncryptedResponseAlg"
										value="#{registrationAction.userInfoEncryptedResponseAlg}" converter="omnifaces.GenericEnumConverter">
										<f:selectItem itemLabel="- Please select one -" />
										<f:selectItems value="#{keyEncryptionAlgorithms}" />
									</h:selectOneMenu>
									<h:outputText></h:outputText>

									<h:outputLabel for="userInfoEncryptedResponseEnc">User Info Encrypted Response Enc</h:outputLabel>
									<h:selectOneMenu id="userInfoEncryptedResponseEnc"
										value="#{registrationAction.userInfoEncryptedResponseEnc}" converter="omnifaces.GenericEnumConverter">
										<f:selectItem itemLabel="- Please select one -" />
										<f:selectItems value="#{blockEncryptionAlgorithms}" />
									</h:selectOneMenu>
									<h:outputText></h:outputText>

									<h:outputLabel for="requestObjectSigningAlg">Request Object Signing Alg</h:outputLabel>
									<h:selectOneMenu id="requestObjectSigningAlg"
										value="#{registrationAction.requestObjectSigningAlg}" converter="omnifaces.GenericEnumConverter">
										<f:selectItem itemLabel="- Please select one -" />
										<f:selectItems value="#{signatureAlgorithms}" />
									</h:selectOneMenu>
									<h:outputText></h:outputText>

									<h:outputLabel for="requestObjectEncryptionAlg">Request Object Encryption Alg</h:outputLabel>
									<h:selectOneMenu id="requestObjectEncryptionAlg"
										value="#{registrationAction.requestObjectEncryptionAlg}" converter="omnifaces.GenericEnumConverter">
										<f:selectItem itemLabel="- Please select one -" />
										<f:selectItems value="#{keyEncryptionAlgorithms}" />
									</h:selectOneMenu>
									<h:outputText></h:outputText>

									<h:outputLabel for="requestObjectEncryptionEnc">Request Object Encryption Enc</h:outputLabel>
									<h:selectOneMenu id="requestObjectEncryptionEnc"
										value="#{registrationAction.requestObjectEncryptionEnc}" converter="omnifaces.GenericEnumConverter">
										<f:selectItem itemLabel="- Please select one -" />
										<f:selectItems value="#{blockEncryptionAlgorithms}" />
									</h:selectOneMenu>
									<h:outputText></h:outputText>

									<h:outputLabel for="tokenEndpointAuthMethod">Token Endpoint Auth Method</h:outputLabel>
									<h:selectOneMenu id="tokenEndpointAuthMethod"
										value="#{registrationAction.tokenEndpointAuthMethod}" converter="omnifaces.GenericEnumConverter">
										<f:selectItem itemLabel="- Please select one -" />
										<f:selectItems value="#{authenticationMethods}" />
									</h:selectOneMenu>
									<h:outputText></h:outputText>

									<h:outputLabel for="tokenEndpointAuthSigningAlg">Token Endpoint Auth Signing Alg</h:outputLabel>
									<h:selectOneMenu id="tokenEndpointAuthSigningAlg"
										value="#{registrationAction.tokenEndpointAuthSigningAlg}" converter="omnifaces.GenericEnumConverter">
										<f:selectItem itemLabel="- Please select one -" />
										<f:selectItems value="#{signatureAlgorithms}" />
									</h:selectOneMenu>
									<h:outputText></h:outputText>

									<h:outputLabel for="defaultMaxAge">Default Maximum Authentication Age</h:outputLabel>
									<h:inputText id="defaultMaxAge"
										value="#{registrationAction.defaultMaxAge}" size="40" />
									<h:outputText>Number of seconds</h:outputText>

									<h:outputLabel for="defaultMaxAge">Require Auth Time</h:outputLabel>
									<h:selectOneRadio id="requireAuthTime"
										value="#{registrationAction.requireAuthTime}">
										<f:selectItem itemValue="#{true}" itemLabel="yes" />
										<f:selectItem itemValue="#{false}" itemLabel="no" />
									</h:selectOneRadio>
									<h:outputText></h:outputText>

									<h:outputLabel for="defaultAcrValues">Default ACR Values (space-separated)</h:outputLabel>
									<h:inputText id="defaultAcrValues"
										value="#{registrationAction.defaultAcrValues}" size="40" />
									<h:outputText></h:outputText>

									<h:outputLabel for="initiateLoginUri">Initiate Login URI</h:outputLabel>
									<h:inputText id="initiateLoginUri"
										value="#{registrationAction.initiateLoginUri}" size="40" />
									<h:outputText></h:outputText>

									<h:outputLabel for="requestUris">Request URIs (space-separated)</h:outputLabel>
									<h:inputText id="requestUris"
										value="#{registrationAction.requestUris}" size="40" />
									<h:outputText></h:outputText>

									<h:outputLabel for="logoutUri">Front Channel Logout URI</h:outputLabel>
									<h:inputText id="logoutUri"
										value="#{registrationAction.logoutUri}" size="40" />
									<h:outputText></h:outputText>

									<h:outputLabel for="logoutSessionRequired">Front Channel Logout Session Required</h:outputLabel>
									<h:selectBooleanCheckbox id="logoutSessionRequired"
										value="#{registrationAction.logoutSessionRequired}" />
									<h:outputText></h:outputText>
								</h:panelGrid>
							</div>
						</h:panelGroup>

						<div class="actionButtons">
							<a4j:commandButton value="Submit"
								action="#{registrationAction.exec}" execute="@region"
								render="registrationResults, clientReadForm, authorizationForm, tokenForm" />
						</div>
					</a4j:region>
					<h:panelGroup layout="block" id="registrationResults">
						<h:panelGroup layout="block" rendered="#{registrationAction.showResults}">
							<br />
							<hr />
							<br />
							<rich:panel>
								<f:facet name="header">Registration Request</f:facet>
								<h:panelGroup layout="block">
									<h:inputTextarea readonly="true" styleClass="width100"
										rows="10" value="#{registrationAction.requestString}" />
								</h:panelGroup>
							</rich:panel>
							<br />
							<rich:panel>
								<f:facet name="header">Registration Response</f:facet>
								<h:panelGroup layout="block">
									<h:inputTextarea readonly="true" styleClass="width100"
										rows="30" value="#{registrationAction.responseString}" />
								</h:panelGroup>
							</rich:panel>
						</h:panelGroup>
					</h:panelGroup>

					<a4j:region>
						<h:panelGroup layout="block" id="clientReadForm">
							<div>
								<br />
								<hr />
								<br /> <strong> Please fill the form to read the
									current configuration of the Client on the Authorization
									Server. </strong>
							</div>
							<div>
								<h:panelGrid columns="3">
									<h:outputLabel for="registrationClientUri">Registration Client URI</h:outputLabel>
									<h:inputText id="registrationClientUri"
										value="#{registrationAction.registrationClientUri}" size="40" />
									<h:outputText></h:outputText>

									<h:outputLabel for="registrationAccessToken">Registration Access Token</h:outputLabel>
									<h:inputText id="registrationAccessToken"
										value="#{registrationAction.registrationAccessToken}"
										size="40" />
									<h:outputText></h:outputText>
								</h:panelGrid>
							</div>
						</h:panelGroup>

						<div class="actionButtons">
							<a4j:commandButton value="Submit"
								action="#{registrationAction.execClientRead}" execute="@region"
								render="clientReadResults" />
						</div>
					</a4j:region>
					<h:panelGroup layout="block" id="clientReadResults">
						<h:panelGroup layout="block" rendered="#{registrationAction.showClientReadResults}">
							<br />
							<hr />
							<br />
							<rich:panel>
								<f:facet name="header">Client Read Request</f:facet>
								<h:panelGroup layout="block">
									<h:inputTextarea readonly="true" styleClass="width100" rows="4"
										value="#{registrationAction.clientReadRequestString}" />
								</h:panelGroup>
							</rich:panel>
							<br />
							<rich:panel>
								<f:facet name="header">Client Read Response</f:facet>
								<h:panelGroup layout="block">
									<h:inputTextarea readonly="true" styleClass="width100"
										rows="30"
										value="#{registrationAction.clientReadResponseString}" />
								</h:panelGroup>
							</rich:panel>
						</h:panelGroup>
					</h:panelGroup>
				</rich:panel>
			</div>

			<br />

			<h:panelGroup layout="block" id="authorizationEndpointDiv">
				<rich:panel>
					<f:facet name="header">Authorization Endpoint</f:facet>
					<h:panelGroup layout="block" id="authorizationForm">
						<div>
							<strong>OAuth 2.0 request parameters</strong>
						</div>
						<div>
							<h:panelGrid columns="3">
								<h:outputLabel for="authorizationEndpoint">Authorization Endpoint</h:outputLabel>
								<h:inputText id="authorizationEndpoint"
									value="#{authorizationAction.authorizationEndpoint}" size="40" />
								<h:outputText>eg: https://seed.gluu.org/oxauth/restv1/authorize</h:outputText>

								<h:outputLabel for="responseType">Response Type</h:outputLabel>
								<h:selectManyListbox id="responseType"
									value="#{authorizationAction.responseTypes}" converter="omnifaces.GenericEnumConverter">
									<f:selectItems value="#{responseTypes}" />
								</h:selectManyListbox>
								<h:outputText></h:outputText>

								<h:outputLabel for="authorizationClientId">Client ID</h:outputLabel>
								<h:inputText id="authorizationClientId"
									value="#{authorizationAction.clientId}" size="40" />
								<h:outputText></h:outputText>

								<h:outputLabel for="scopes">Scope</h:outputLabel>
								<h:selectManyListbox id="scopes"
									value="#{authorizationAction.scopes}">
									<f:selectItem itemLabel="openid" itemValue="openid" />
									<f:selectItem itemLabel="profile" itemValue="profile" />
									<f:selectItem itemLabel="address" itemValue="address" />
									<f:selectItem itemLabel="email" itemValue="email" />
									<f:selectItem itemLabel="phone" itemValue="phone" />
								</h:selectManyListbox>
								<h:outputText></h:outputText>

								<h:outputLabel for="authorizationRedirectUri">Redirect URI</h:outputLabel>
								<h:inputText id="authorizationRedirectUri"
									value="#{authorizationAction.redirectUri}" size="40" />
								<h:outputText>eg: https://seed.gluu.org/oxauth-rp/home.htm</h:outputText>

								<h:outputLabel for="authorizationState">State</h:outputLabel>
								<h:inputText id="authorizationState"
									value="#{authorizationAction.state}" size="40" />
								<h:outputText></h:outputText>
							</h:panelGrid>
						</div>
						<div>
							<strong>OpenID Connect request parameters</strong>
						</div>
						<div>
							<h:panelGrid columns="3">
								<h:outputLabel for="nonce">Nonce</h:outputLabel>
								<h:inputText id="nonce" value="#{authorizationAction.nonce}"
									size="40" />
								<h:outputText></h:outputText>

								<h:outputLabel for="display">Display</h:outputLabel>
								<h:selectOneMenu id="display"
									value="#{authorizationAction.display}" converter="omnifaces.GenericEnumConverter">
									<f:selectItems value="#{displays}" />
								</h:selectOneMenu>
								<h:outputText></h:outputText>

								<h:outputLabel for="prompt">Prompt</h:outputLabel>
								<h:selectManyListbox id="prompt"
									value="#{authorizationAction.prompt}" converter="omnifaces.GenericEnumConverter">
									<f:selectItems value="#{prompts}" />
								</h:selectManyListbox>
								<h:outputText></h:outputText>

								<h:outputLabel for="maxAge">Maximum Authentication Age</h:outputLabel>
								<h:inputText id="maxAge" value="#{authorizationAction.maxAge}"
									size="40" />
								<h:outputText>Number of seconds</h:outputText>

								<h:outputLabel for="uiLocales">UI Locales (space-separated)</h:outputLabel>
								<h:inputText id="uiLocales"
									value="#{authorizationAction.uiLocales}" size="40" />
								<h:outputText></h:outputText>

								<h:outputLabel for="claimsLocales">Claims Locales (space-separated)</h:outputLabel>
								<h:inputText id="claimsLocales"
									value="#{authorizationAction.claimsLocales}" size="40" />
								<h:outputText></h:outputText>

								<h:outputLabel for="idTokenHint">ID Token Hint</h:outputLabel>
								<h:inputText id="idTokenHint"
									value="#{authorizationAction.idTokenHint}" size="40" />
								<h:outputText></h:outputText>

								<h:outputLabel for="loginHint">Login Hint</h:outputLabel>
								<h:inputText id="loginHint"
									value="#{authorizationAction.loginHint}" size="40" />
								<h:outputText></h:outputText>

								<h:outputLabel for="acrValues">ACR Values (space-separated)</h:outputLabel>
								<h:inputText id="acrValues"
									value="#{authorizationAction.acrValues}" size="40" />
								<h:outputText></h:outputText>

								<h:outputLabel for="claims">Claims (JSON Object)</h:outputLabel>
								<h:inputTextarea id="claims"
									value="#{authorizationAction.claims}" rows="10" cols="45">
									<f:validator validatorId="jsonValidator" />
									<rich:validator event="blur" />
								</h:inputTextarea>
								<rich:message for="claims" style="color: red" />

								<h:outputLabel for="registration">Registration</h:outputLabel>
								<h:inputText id="registration"
									value="#{authorizationAction.registration}" size="40" />
								<h:outputText></h:outputText>

								<h:outputLabel for="requestUri">Request URI</h:outputLabel>
								<h:inputText id="requestUri"
									value="#{authorizationAction.requestUri}" size="40" />
								<h:outputText></h:outputText>
							</h:panelGrid>
						</div>
						<div>
							<strong>OpenID Request Object</strong>
						</div>
						<div>
							<h:panelGrid columns="2">
								<h:outputLabel for="useOpenIdRequestObject">Use OpenID Request Object</h:outputLabel>
								<h:selectBooleanCheckbox id="useOpenIdRequestObject"
									value="#{authorizationAction.useOpenIdRequestObject}">
									<a4j:ajax event="change" execute="@this"
										render="authorizationEndpointDiv" />
								</h:selectBooleanCheckbox>
							</h:panelGrid>
							<h:panelGroup layout="block" rendered="#{authorizationAction.useOpenIdRequestObject}">
								<h:panelGrid columns="2">
									<h:outputLabel for="signOrEncryptRequestObject">Sign/Encrypted the JWT Request Object</h:outputLabel>
									<h:selectOneRadio id="signOrEncryptRequestObject"
										value="#{authorizationAction.signOrEncryptRequestObject}">
										<f:selectItem itemValue="JWS" itemLabel="JWS" />
										<f:selectItem itemValue="JWE" itemLabel="JWE" />
										<a4j:ajax event="change" render="authorizationEndpointDiv"
											execute="@this" />
									</h:selectOneRadio>
									<h:outputText></h:outputText>
								</h:panelGrid>
								<h:panelGrid columns="3">
									<h:outputLabel for="authorizationRequestObjectSigningAlg"
										rendered="#{authorizationAction.JWSSelected}">Request Object Signing Alg</h:outputLabel>
									<h:selectOneMenu id="authorizationRequestObjectSigningAlg"
										value="#{authorizationAction.requestObjectSigningAlg}"
										rendered="#{authorizationAction.JWSSelected}" converter="omnifaces.GenericEnumConverter">
										<f:selectItems value="#{signatureAlgorithms}" />

										<a4j:ajax event="change" render="authorizationEndpointDiv"
											execute="@this" />
									</h:selectOneMenu>
									<h:outputText rendered="#{authorizationAction.JWSSelected}"></h:outputText>

									<h:outputLabel for="authorizationRequestObjectEncryptionAlg"
										rendered="#{authorizationAction.JWESelected}">Request Object Encryption Alg</h:outputLabel>
									<h:selectOneMenu id="authorizationRequestObjectEncryptionAlg"
										value="#{authorizationAction.requestObjectEncryptionAlg}"
										rendered="#{authorizationAction.JWESelected}" converter="omnifaces.GenericEnumConverter">
										<f:selectItems value="#{keyEncryptionAlgorithms}" />

										<a4j:ajax event="change" render="authorizationEndpointDiv"
											execute="@this" />
									</h:selectOneMenu>
									<h:outputText rendered="#{authorizationAction.JWESelected}"></h:outputText>

									<h:outputLabel for="authorizationRequestObjectEncryptionEnc"
										rendered="#{authorizationAction.JWESelected}">Request Object Encryption Enc</h:outputLabel>
									<h:selectOneMenu id="authorizationRequestObjectEncryptionEnc"
										value="#{authorizationAction.requestObjectEncryptionEnc}"
										rendered="#{authorizationAction.JWESelected}" converter="omnifaces.GenericEnumConverter">
										<f:selectItems value="#{blockEncryptionAlgorithms}" />
									</h:selectOneMenu>
									<h:outputText rendered="#{authorizationAction.JWESelected}"></h:outputText>

                                    <h:outputLabel for="keyStoreFile"
                                                   rendered="#{authorizationAction.keyStoreRequired}">Key Store File</h:outputLabel>
                                    <h:inputText id="keyStoreFile"
                                                 value="#{authorizationAction.keyStoreFile}"
                                                 rendered="#{authorizationAction.keyStoreRequired}" size="40" />
                                    <h:outputText value="eg: /etc/certs/client_keystore.jks"
                                                  rendered="#{authorizationAction.keyStoreRequired}"/>

                                    <h:outputLabel for="keyStoreSecret"
                                                   rendered="#{authorizationAction.keyStoreRequired}">Key Store Secret</h:outputLabel>
                                    <h:inputText id="keyStoreSecret"
                                                 value="#{authorizationAction.keyStoreSecret}"
                                                 rendered="#{authorizationAction.keyStoreRequired}" size="40" />
                                    <h:outputText rendered="#{authorizationAction.keyStoreRequired}"></h:outputText>

									<h:outputLabel for="authorizationKeyId"
										rendered="#{authorizationAction.keyIdRequired}">Key ID</h:outputLabel>
									<h:inputText id="authorizationKeyId"
										value="#{authorizationAction.keyId}"
										rendered="#{authorizationAction.keyIdRequired}" size="40" />
									<h:outputText rendered="#{authorizationAction.keyIdRequired}" />

									<h:outputLabel for="authorizationClientSecret"
										rendered="#{authorizationAction.clientSecretRequired}">Client Secret</h:outputLabel>
									<h:inputText id="authorizationClientSecret"
										value="#{authorizationAction.clientSecret}"
										rendered="#{authorizationAction.clientSecretRequired}"
										size="40" />
									<h:outputText
										rendered="#{authorizationAction.clientSecretRequired}" />

									<h:outputLabel for="openIdRequestObject">OpenID Request Object</h:outputLabel>
									<h:inputTextarea id="openIdRequestObject"
										value="#{authorizationAction.openIdRequestObject}" rows="20"
										cols="45">
										<f:validator validatorId="jsonValidator" />
										<rich:validator event="blur" />
									</h:inputTextarea>
									<rich:message for="openIdRequestObject" style="color: red" />
								</h:panelGrid>
							</h:panelGroup>
						</div>
					</h:panelGroup>

					<div class="actionButtons">
						<h:commandButton value="Submit"
							action="#{authorizationAction.exec}" />
					</div>

					<h:panelGroup layout="block" id="authorizationResults">
						<h:panelGroup layout="block" rendered="#{authorizationAction.showResults}">
							<br />
							<hr />
							<br />
							<rich:panel>
								<f:facet name="header">Authorization Request</f:facet>
								<h:panelGroup layout="block">
									<h:inputTextarea readonly="true" styleClass="width100"
													 rows="10" value="#{authorizationAction.requestString}" />
								</h:panelGroup>
							</rich:panel>
							<br />
							<rich:panel>
								<f:facet name="header">Authorization Response (Parameters)</f:facet>
								<h:panelGroup layout="block">
									<h:inputTextarea id="authorizationResponse" styleClass="width100"
													 value="#{authorizationAction.responseString}" rows="10" />
								</h:panelGroup>
							</rich:panel>
						</h:panelGroup>
					</h:panelGroup>
				</rich:panel>
			</h:panelGroup>

			<br />

			<div>
				<rich:panel>
					<f:facet name="header">Token Endpoint</f:facet>
					<a4j:region>
						<h:panelGroup layout="block" id="tokenForm">
							<div>
								<strong>Required parameters</strong>
							</div>
							<div>
								<h:panelGrid columns="3">
									<h:outputLabel for="tokenEndpoint">Token Endpoint</h:outputLabel>
									<h:inputText id="tokenEndpoint"
										value="#{tokenAction.tokenEndpoint}" size="40" />
									<h:outputText>eg: https://seed.gluu.org/oxauth/restv1/token</h:outputText>

									<h:outputLabel for="grantType">Grant Type</h:outputLabel>
									<h:selectOneMenu id="grantType"
										value="#{tokenAction.grantType}" converter="omnifaces.GenericEnumConverter">
										<f:selectItem itemLabel="- Please select one -" />
										<f:selectItems value="#{grantTypes}" />
									</h:selectOneMenu>
									<h:outputText></h:outputText>

									<h:outputLabel for="tokenClientId">Client ID</h:outputLabel>
									<h:inputText id="tokenClientId" value="#{tokenAction.clientId}"
										size="40" />
									<h:outputText></h:outputText>

									<h:outputLabel for="clientSecret">Client Secret</h:outputLabel>
									<h:inputText id="clientSecret"
										value="#{tokenAction.clientSecret}" size="40" />
									<h:outputText></h:outputText>
								</h:panelGrid>
							</div>
							<div>
								<strong>Optional parameters</strong>
							</div>
							<div>
								<h:panelGrid columns="3">
									<h:outputLabel for="code">Code</h:outputLabel>
									<h:inputText id="code" value="#{tokenAction.code}" size="40" />
									<h:outputText></h:outputText>

									<h:outputLabel for="tokenRedirectUri">Redirect URI</h:outputLabel>
									<h:inputText id="tokenRedirectUri"
										value="#{tokenAction.redirectUri}" size="40" />
									<h:outputText>eg: https://seed.gluu.org/oxauth-rp/home.htm</h:outputText>

									<h:outputLabel for="username">Username</h:outputLabel>
									<h:inputText id="username" value="#{tokenAction.username}"
										size="40" />
									<h:outputText></h:outputText>

									<h:outputLabel for="password">Password</h:outputLabel>
									<h:inputSecret id="password" value="#{tokenAction.password}"
										size="40" />
									<h:outputText></h:outputText>

									<h:outputLabel for="scope">Scope</h:outputLabel>
									<h:inputText id="scope" value="#{tokenAction.scope}" size="40" />
									<h:outputText>eg: openid profile address email phone</h:outputText>

									<h:outputLabel for="assertion">Assertion</h:outputLabel>
									<h:inputText id="assertion" value="#{tokenAction.assertion}"
										size="40" />
									<h:outputText></h:outputText>

									<h:outputLabel for="refreshToken">Refresh Token</h:outputLabel>
									<h:inputText id="refreshToken"
										value="#{tokenAction.refreshToken}" size="40" />
									<h:outputText></h:outputText>
								</h:panelGrid>
							</div>
							<div>
								<strong>Authentication Method</strong>
							</div>
							<div>
								<h:panelGrid columns="2">
									<h:selectOneMenu id="tokenAuthenticationMethod"
										value="#{tokenAction.authenticationMethod}" converter="omnifaces.GenericEnumConverter">
										<f:selectItems value="#{authenticationMethods}" />
									</h:selectOneMenu>
								</h:panelGrid>
							</div>
						</h:panelGroup>

						<div class="actionButtons">
							<a4j:commandButton value="Submit" action="#{tokenAction.exec}"
								execute="@region" render="tokenResults, userInfoForm" />
						</div>
					</a4j:region>
					<h:panelGroup layout="block" id="tokenResults">
						<h:panelGroup layout="block" rendered="#{tokenAction.showResults}">
							<br />
							<hr />
							<br />
							<rich:panel>
								<f:facet name="header">Token Request</f:facet>
								<h:panelGroup layout="block">
									<h:inputTextarea readonly="true" styleClass="width100" rows="5"
										value="#{tokenAction.requestString}" />
								</h:panelGroup>
							</rich:panel>
							<br />
							<rich:panel>
								<f:facet name="header">Token Response</f:facet>
								<h:panelGroup layout="block">
									<h:inputTextarea readonly="true" styleClass="width100" rows="5"
										value="#{tokenAction.responseString}" />
								</h:panelGroup>
							</rich:panel>
						</h:panelGroup>
					</h:panelGroup>
				</rich:panel>
			</div>

			<br />

			<div>
				<rich:panel>
					<f:facet name="header">Check Session Endpoint</f:facet>
					<h:panelGroup layout="block" id="checkSessionForm">
						<iframe id="op" style="visibility: hidden" height="0" width="0"
							src="#{checkSessionAction.checkSessionEndpoint}" />
						<iframe id="rp" style="visibility: hidden" height="0" width="0" />

						<h:panelGroup layout="block" rendered="#{openIdConnectDiscoveryAction.showResults}">
							<h:panelGrid columns="3">
								<h:outputLabel for="opIFrame">OP IFrame</h:outputLabel>
								<h:inputText id="opIFrame"
									value="#{checkSessionAction.checkSessionEndpoint}" size="40"
									readonly="true" />
								<h:outputText></h:outputText>

								<h:outputLabel for="rpIFrame">RP IFrame</h:outputLabel>
								<h:inputText id="rpIFrame" size="40" readonly="true" />
								<h:outputText></h:outputText>

								<h:outputLabel for="checkSessionOpOrigin">OP Origin</h:outputLabel>
								<h:inputText id="checkSessionOpOrigin"
									value="https://#{openIdConnectDiscoveryAction.host}" size="40"
									readonly="true" />
								<h:outputText></h:outputText>
							</h:panelGrid>
						</h:panelGroup>
					</h:panelGroup>
				</rich:panel>
			</div>

			<br />

			<div>
				<rich:panel>
					<f:facet name="header">User Info Endpoint</f:facet>
					<a4j:region>
						<h:panelGroup layout="block" id="userInfoForm">
							<div>
								<strong>Required Parameters</strong>
							</div>
							<div>
								<h:panelGrid columns="3">
									<h:outputLabel for="userInfoEndpoint">User Info Endpoint</h:outputLabel>
									<h:inputText id="userInfoEndpoint"
										value="#{userInfoAction.userInfoEndpoint}" size="40" />
									<h:outputText>eg: https://seed.gluu.org/oxauth/restv1/userinfo</h:outputText>

									<h:outputLabel for="userInfoAccessToken">Access Token</h:outputLabel>
									<h:inputText id="userInfoAccessToken"
										value="#{userInfoAction.accessToken}" size="40" />
									<h:outputText></h:outputText>
								</h:panelGrid>
							</div>
							<div>
								<strong>Authentication Method</strong>
							</div>
							<div>
								<h:panelGrid columns="2">
									<h:selectOneMenu id="userInfoAuthorizationMethod"
										value="#{userInfoAction.authorizationMethod}" converter="omnifaces.GenericEnumConverter">
										<f:selectItems value="#{authorizationMethods}" />
									</h:selectOneMenu>
								</h:panelGrid>
							</div>
						</h:panelGroup>

						<div class="actionButtons">
							<a4j:commandButton value="Submit" action="#{userInfoAction.exec}"
								execute="@region" render="userInfoResults" />
						</div>
					</a4j:region>
					<h:panelGroup layout="block" id="userInfoResults">
						<h:panelGroup layout="block" rendered="#{userInfoAction.showResults}">
							<br />
							<hr />
							<br />
							<rich:panel>
								<f:facet name="header">User Info Request</f:facet>
								<h:panelGroup layout="block">
									<h:inputTextarea readonly="true" styleClass="width100" rows="5"
										value="#{userInfoAction.requestString}" />
								</h:panelGroup>
							</rich:panel>
							<br />
							<rich:panel>
								<f:facet name="header">User Info Response</f:facet>
								<h:panelGroup layout="block">
									<h:inputTextarea readonly="true" styleClass="width100"
										rows="10" value="#{userInfoAction.responseString}" />
								</h:panelGroup>
							</rich:panel>
						</h:panelGroup>
					</h:panelGroup>
				</rich:panel>
			</div>

			<br />

			<div>
				<rich:panel>
					<f:facet name="header">End Session Endpoint</f:facet>
					<a4j:region>
						<h:panelGroup layout="block" id="endSessionForm">
							<div>
								<strong></strong>
							</div>
							<div>
								<h:panelGrid columns="3">
									<h:outputLabel for="endSessionEndpoint">End Session Endpoint</h:outputLabel>
									<h:inputText id="endSessionEndpoint"
										value="#{endSessionAction.endSessionEndpoint}" size="40" />
									<h:outputText>eg: https://seed.gluu.org/oxauth/restv1/end_session</h:outputText>

									<h:outputLabel for="endSessionIdTokenHint">ID Token Hint</h:outputLabel>
									<h:inputText id="endSessionIdTokenHint"
										value="#{endSessionAction.idTokenHint}" size="40" />
									<h:outputText></h:outputText>

									<h:outputLabel for="endSessionPostLogoutRedirectUri">Post Logout Redirect URI</h:outputLabel>
									<h:inputText id="endSessionPostLogoutRedirectUri"
										value="#{endSessionAction.postLogoutRedirectUri}" size="40" />
									<h:outputText>eg: https://seed.gluu.org/oxauth-rp/home.htm</h:outputText>

									<h:outputLabel for="endSessionState">State</h:outputLabel>
									<h:inputText id="endSessionState"
										value="#{endSessionAction.state}" size="40" />
									<h:outputText></h:outputText>
								</h:panelGrid>
							</div>
						</h:panelGroup>

						<div class="actionButtons">
							<a4j:commandButton value="Submit"
								action="#{endSessionAction.exec}" execute="@region"
								render="endSessionResults" />
						</div>
					</a4j:region>
				</rich:panel>
			</div>

		</h:form>

		<script type="text/javascript">
    //<![CDATA[
    var params = null;
    if (self.document.location.hash) {
        var hash = self.document.location.hash.substring(1);
        hash = decodeURI(hash.replace(/\+/g, " "));
        params = hash.split("&");
    } else {
        var query = window.location.search.slice(1);
        params = query.split("&");
    }

    if (params != null) {
		var authorizationResponse = document.getElementById("mainForm:authorizationResponse");
		if (authorizationResponse != null) {
			authorizationResponse.value = params;
		}

        for (var i = 0; i < params.length; i++) {
            var param = params[i].split("=");

            if (param[0] == "code") {
                document.getElementById("mainForm:code").value = param[1];
            } else if (param[0] == "access_token") {
                document.getElementById("mainForm:userInfoAccessToken").value = param[1];
            } else if (param[0] == "id_token") {
                document.getElementById("mainForm:endSessionIdTokenHint").value = param[1];
            } else if (param[0] == "scope") {
                document.getElementById("mainForm:scope").value = param[1];
            } else if (param[0] == "session_state") {
                var rp = document.getElementById("rp");
                var clientIdValue = document.getElementById("mainForm:authorizationClientId").value;
                var opOrigin = document.getElementById("mainForm:checkSessionOpOrigin");
                if (opOrigin != null) {
	                var opOriginValue = opOrigin.value;
	
	                var rpIFrame = "./rpiframe.htm?session_state=" + param[1]
	                        + "&client_id=" + clientIdValue + "&op_origin=" + opOriginValue;
	
	                document.getElementById("mainForm:rpIFrame").value = rpIFrame;
	
	                rp.src = rpIFrame;
            	}
            }
        }
    }
    //]]>
</script>

	</ui:define>
</ui:composition>
